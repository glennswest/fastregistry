{{define "release-detail-content"}}
<div class="release-detail-header">
  <h1 class="page-title">Release {{.Content.Release.Version}}</h1>
  <span class="release-badge badge-{{.Content.Release.StateBadge}}">{{.Content.Release.State}}</span>
</div>
<p class="page-subtitle">{{.Content.Release.Architecture}}</p>

<!-- Stats Row -->
<div class="stats-row">
  <div class="stat-card">
    <div class="stat-label">State</div>
    <div class="stat-value" style="font-size:16px;">
      <span class="release-badge badge-{{.Content.Release.StateBadge}}">{{.Content.Release.State}}</span>
    </div>
  </div>
  <div class="stat-card">
    <div class="stat-label">Architecture</div>
    <div class="stat-value" style="font-size:16px;">{{.Content.Release.Architecture}}</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">Discovered</div>
    <div class="stat-value" style="font-size:16px;">{{.Content.Release.DiscoveredAt}}</div>
  </div>
  {{if .Content.TotalSize}}
  <div class="stat-card">
    <div class="stat-label">Total Size</div>
    <div class="stat-value" style="font-size:16px;">{{.Content.TotalSize}}</div>
  </div>
  {{end}}
</div>

{{if .Content.Release.HasError}}
<div class="stat-card" style="border-color:var(--accent-red);margin-bottom:24px;">
  <div class="stat-label" style="color:var(--accent-red);">Error</div>
  <div style="color:var(--accent-red);font-size:13px;">{{.Content.Release.Error}}</div>
</div>
{{end}}

{{if .Content.HasManifest}}
<!-- Manifest Overview -->
<div class="section">
  <div class="section-title">Manifest</div>
  <div class="manifest-overview">
    <div class="manifest-card">
      <div class="manifest-card-label">Digest</div>
      <div class="manifest-card-value mono">{{.Content.Manifest.Digest}}</div>
    </div>
    <div class="manifest-card">
      <div class="manifest-card-label">Size</div>
      <div class="manifest-card-value">{{.Content.Manifest.SizeHuman}}</div>
    </div>
    <div class="manifest-card">
      <div class="manifest-card-label">Created</div>
      <div class="manifest-card-value">{{.Content.Manifest.CreatedHuman}}</div>
    </div>
    <div class="manifest-card">
      <div class="manifest-card-label">Media Type</div>
      <div class="manifest-card-value mono" style="font-size:12px">{{.Content.Manifest.MediaType}}</div>
    </div>
  </div>
</div>

<!-- Layers -->
{{if .Content.Manifest.Layers}}
<div class="section layers-section">
  <div class="layers-title">Layers <span class="count" style="font-size:12px;font-weight:500;color:var(--text-tertiary)">{{len .Content.Manifest.Layers}}</span></div>
  <div class="table-wrapper">
    {{range $i, $layer := .Content.Manifest.Layers}}
    <div class="layer-row">
      <div class="layer-index">{{inc $i}}</div>
      <div class="layer-bar-wrapper">
        <div class="layer-bar" style="width: {{$layer.SizePercent}}%"></div>
      </div>
      <div class="layer-digest" title="{{$layer.Digest}}">{{$layer.DigestShort}}</div>
      <div class="layer-size">{{$layer.SizeHuman}}</div>
    </div>
    {{end}}
  </div>
</div>
{{end}}

<!-- Annotations -->
{{if .Content.Manifest.Annotations}}
<div class="section annotations-table">
  <div class="annotations-title">Annotations</div>
  <div class="table-wrapper">
    <table class="data-table">
      <thead>
        <tr>
          <th>Key</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        {{range $k, $v := .Content.Manifest.Annotations}}
        <tr>
          <td class="mono">{{$k}}</td>
          <td>{{$v}}</td>
        </tr>
        {{end}}
      </tbody>
    </table>
  </div>
</div>
{{end}}

{{else if eq .Content.Release.State "available"}}
<!-- Not yet cloned -->
<div class="section">
  <div class="empty-state">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
    <h3>Clone this release to view manifest details</h3>
    <p>The manifest and layer breakdown will be available after cloning from upstream.</p>
    <div style="margin-top:16px;">
      <button class="btn btn-primary"
        onclick="fetch('/admin/releases/clone', {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({version:'{{.Content.Release.Version}}'})}).then(() => window.location.reload())">
        Clone {{.Content.Release.Version}}
      </button>
    </div>
  </div>
</div>
{{end}}

<!-- Artifacts -->
{{if .Content.Artifacts}}
<div class="section">
  <div class="section-title">Artifacts <span class="count" style="font-size:12px;font-weight:500;color:var(--text-tertiary)">{{len .Content.Artifacts}}</span></div>
  <div class="table-wrapper">
    <table class="data-table artifact-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Size</th>
          <th>SHA256</th>
          <th>Download</th>
        </tr>
      </thead>
      <tbody>
        {{range .Content.Artifacts}}
        <tr>
          <td style="font-weight:600;">{{.Name}}</td>
          <td><span class="tag-badge">{{.Type}}</span></td>
          <td>{{.Size}}</td>
          <td class="sha256" title="{{.SHA256}}">{{.SHA256}}</td>
          <td><a href="{{.DownloadURL}}" class="btn btn-sm btn-ghost">Download</a></td>
        </tr>
        {{end}}
      </tbody>
    </table>
  </div>
</div>
{{end}}

{{end}}
